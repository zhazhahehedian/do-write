package com.dpbug.server.ai.prompt;

/**
 * 提示词模板常量类
 * <p>
 * 包含所有AI生成任务的提示词模板。
 * </p>
 * <p>
 * 使用方法：
 * <pre>
 * String prompt = PromptTemplates.WORLD_BUILDING
 *     .replace("{title}", project.getTitle())
 *     .replace("{theme}", project.getTheme())
 *     // ...
 * </pre>
 * </p>
 */
public final class PromptTemplates {

    private PromptTemplates() {
        // 工具类，禁止实例化
    }

    // ==================== 世界观生成 ====================

    /**
     * 世界观构建提示词
     * <p>
     * 参数：
     * - {title}: 书名
     * - {theme}: 主题
     * - {genre}: 类型
     * - {description}: 简介
     * </p>
     */
    public static final String WORLD_BUILDING = """
            你是一位资深的世界观设计师。基于以下输入信息，构建一个高度原创、深度自洽、充满戏剧冲突的小说世界观。

            # 输入信息
            书名：{title}
            主题：{theme}
            类型：{genre}
            简介：{description}

            # 核心要求
            * **简介契合性**：世界观设定必须能够支撑简介中描述的故事情节和核心矛盾
            * **类型适配性**：世界观必须符合小说类型的特征，不要生成不匹配的设定
            * **主题贴合性**：时代背景要能有效支撑和体现小说主题
            * **原创性**：在类型框架内发挥创意，创造独特但合理的世界设定
            * **具象化**：避免空洞概念，用具体可感的细节描述世界
            * **逻辑自洽**：确保所有设定相互支撑，形成完整体系
            * **戏剧张力**：设定要能为故事冲突提供支撑，尤其要为简介中的故事线索创造合适的环境

            # 类型指导原则
            根据小说类型选择适当的设定风格：

            **现代都市/言情/青春**：
            - 时间设定：当代现实社会（2020年代）或近未来（2030-2050年）
            - 避免使用：大崩解、纪元、末日、重生等宏大概念
            - 重点描述：具体的城市环境、社会现状、文化氛围
            - 例如：一线城市的竞争压力、职场文化、代际冲突、社交媒体影响等

            **历史/古代**：
            - 时间设定：明确的历史朝代或虚构但有历史感的古代社会
            - 避免使用：科技元素、未来概念
            - 重点描述：时代特征、礼教制度、阶级分化

            **玄幻/仙侠/修真**：
            - 时间设定：修炼文明的特定时期，可以有门派兴衰、修炼体系变革
            - 可以使用宏大设定，但要与修炼体系紧密结合
            - 重点描述：修炼规则、灵气环境、门派势力

            **科幻**：
            - 时间设定：未来某个明确时期（如2150年、星际时代初期等）
            - 可以有文明转折，但要具体说明科技水平和社会形态
            - 避免空泛的纪元名称，多用具体的科技特征描述

            **奇幻/魔法**：
            - 时间设定：魔法文明的特定阶段
            - 重点描述：魔法体系、种族关系、大陆格局

            **悬疑/推理/惊悚**：
            - 时间设定：当代或历史某个时期
            - 重点描述：案件背景、社会环境、人际关系网

            **军事/战争**：
            - 时间设定：战争时期的具体年代
            - 重点描述：战争形势、阵营对立、军事科技水平

            # 设定尺度控制
            **切记：不要为所有类型都生成宏大的世界观！**

            - 如果是现代都市题材，就写现实社会的某个城市、某个行业、某个阶层
            - 如果是校园青春，就写学校环境、学生生活、成长困境
            - 如果是职场言情，就写公司文化、行业特点、职业压力
            - 只有史诗级题材（玄幻、科幻、奇幻等）才需要宏大的世界观架构

            # 输出要求
            生成包含以下四个字段的JSON对象，每个字段用300-500字的连贯段落描述：

            1. **time_period**（时间背景与社会状态）
               - **重要**：根据类型和主题，设定合适规模的时间背景
               - 现代题材：描述当前社会的具体特征（如：2024年的北京，互联网行业高速发展...）
               - 历史题材：明确朝代和历史阶段（如：明朝嘉靖年间，海禁政策下的沿海地区...）
               - 幻想题材：描述文明发展阶段，但要具体而非空泛（如：大陆诸国林立的战国时代，而非"XX纪元"）
               - 阐明时代核心矛盾和社会焦虑（要贴合主题）

            2. **location**（空间环境与地理特征）
               - 描绘故事主要发生的空间环境（具体的城市、地区、场所）
               - 现代题材：具体城市名或城市类型（一线城市、沿海城市、内陆小城等）
               - 说明环境如何影响居民的生存方式
               - 刻画能代表世界独特性的标志性场景

            3. **atmosphere**（感官体验与情感基调）
               - 描述身临其境的感官细节（视觉、听觉、嗅觉等）
               - 阐述世界的美学风格和色彩基调
               - 刻画居民普遍的心理状态和情绪氛围
               - **要与主题情感呼应**（如竞争焦虑、成长迷茫、爱情憧憬等）

            4. **rules**（世界规则与社会结构）
               - 阐明世界运行的核心法则和底层逻辑
               - 现代题材：社会规则、行业潜规则、人际交往法则
               - 幻想题材：力量体系、社会等级、资源分配
               - 描述权力结构和利益格局
               - 揭示社会禁忌及违反后的后果

            # 格式规范
            1. **纯JSON输出**：只输出JSON对象，以左花括号开始、右花括号结束
            2. **无额外标记**：不要包含markdown标记、代码块符号或任何说明文字
            3. **纯文本值**：每个字段值必须是完整的段落文本，不使用嵌套结构
            4. **无特殊符号**：文本中不使用引号、方括号等特殊符号包裹内容
            5. **丰富细节**：每个字段提供充实的原创内容，避免模板化表达

            请根据输入的书名、类型、主题和简介，生成**规模适当、风格匹配、能够支撑故事发展**的世界观设定。

            **特别提醒**：
            - 简介是故事的核心概括，世界观必须为简介中描述的情节提供合理的发生背景
            - 所有设定都应该能够自然地承载简介中的故事线
            - 如果简介中有特定的场景、冲突或设定，世界观要与之呼应

            # JSON格式示例

            {
              "time_period": "时间背景与社会状态的详细描述（300-500字）",
              "location": "空间环境与地理特征的详细描述（300-500字）",
              "atmosphere": "感官体验与情感基调的详细描述（300-500字）",
              "rules": "世界规则与社会结构的详细描述（300-500字）"
            }
            """;

    // ==================== 角色生成 ====================

    /**
     * 批量角色生成提示词
     * <p>
     * 参数：
     * - {count}: 生成数量
     * - {time_period}: 时间背景
     * - {location}: 地理位置
     * - {atmosphere}: 氛围基调
     * - {rules}: 世界规则
     * - {theme}: 主题
     * - {genre}: 类型
     * - {requirements}: 特殊要求
     * </p>
     */
    public static final String CHARACTERS_BATCH_GENERATION = """
            你是一位专业的角色设定师。请根据以下世界观和要求，生成{count}个立体丰满的角色和组织：

            世界观信息：
            - 时间背景：{time_period}
            - 地理位置：{location}
            - 氛围基调：{atmosphere}
            - 世界规则：{rules}

            主题：{theme}
            类型：{genre}
            特殊要求：{requirements}

            【数量要求 - 必须严格遵守】
            请精确生成{count}个实体，不多不少。数组中必须包含且仅包含{count}个对象。

            实体类型分配：
            - 至少1个主角（protagonist）
            - 多个配角（supporting）
            - 可以包含反派（antagonist）
            - 可以包含1-2个**高影响力的重要组织**（势力等级应在70-95之间）

            要求：
            - 角色要符合世界观设定
            - 性格和背景要有深度
            - 角色之间要有关系网络
            - 组织要有存在的合理性
            - 所有实体要为故事服务

            **重要格式要求：**
            1. 只返回纯JSON数组格式，不要包含任何markdown标记、代码块标记或其他说明文字
            2. JSON字符串值的内容描述中严禁使用任何特殊符号（包括中文引号、英文引号、方括号、书名号等）
            3. 所有专有名词、地点、人物、组织名称等直接书写，不使用任何符号包裹

            请严格按照以下JSON数组格式返回（每个角色为数组中的一个对象）：
            [
              {
                "name": "角色姓名",
                "age": 25,
                "gender": "男/女/其他",
                "is_organization": false,
                "role_type": "protagonist/supporting/antagonist",
                "personality": "性格特点的详细描述（100-200字），包括核心性格、优缺点、特殊习惯",
                "background": "背景故事的详细描述（100-200字），包括家庭背景、成长经历、重要转折",
                "appearance": "外貌描述（50-100字），包括身高、体型、面容、着装风格",
                "traits": ["特长1", "特长2", "特长3"],
                "relationships_array": [
                  {
                    "target_character_name": "已生成的角色名称",
                    "relationship_type": "关系类型（师父/朋友/敌人/父亲/母亲等）",
                    "intimacy_level": 75,
                    "description": "关系描述"
                  }
                ],
                "organization_memberships": [
                  {
                    "organization_name": "已生成的组织名称",
                    "position": "职位",
                    "rank": 5,
                    "loyalty": 80
                  }
                ]
              },
              {
                "name": "组织名称",
                "is_organization": true,
                "role_type": "supporting",
                "personality": "组织特性描述（100-200字），包括运作方式、核心理念、行事风格",
                "background": "组织背景（100-200字），包括建立历史、发展历程、重要事件",
                "appearance": "组织外在表现（50-100字），如总部位置、标志性建筑等",
                "organization_type": "组织类型",
                "organization_purpose": "组织目的",
                "organization_members": ["成员1", "成员2"],
                "power_level": 85,
                "location": "组织所在地或主要活动区域",
                "motto": "组织格言、口号或宗旨",
                "color": "组织代表颜色（如：深红色、金色、黑色等）",
                "traits": []
              }
            ]

            **组织生成要求（重要）：**
            - 组织必须是对故事有重大影响的势力
            - power_level应在70-95之间（高影响力组织）
            - 不要生成无关紧要的小组织或普通社团
            - 组织应该是推动剧情发展的关键力量
            - 可以是正派势力、中立势力或反派势力，但一定要有存在感

            **关系类型参考（从中选择或自定义）：**
            - 家族：父亲、母亲、兄弟、姐妹、子女、配偶、恋人
            - 社交：师父、徒弟、朋友、同学、同事、邻居、知己
            - 职业：上司、下属、合作伙伴
            - 敌对：敌人、仇人、竞争对手、宿敌

            **重要说明：**
            1. **数量控制**：数组中必须精确包含{count}个对象，不能多也不能少
            2. **关系约束**：relationships_array只能引用本批次中已经出现的角色名称
            3. **组织约束**：organization_memberships只能引用本批次中is_organization=true的实体名称
            4. **禁止幻觉**：不要引用任何不存在的角色或组织，如果没有可引用的就留空数组[]
            5. **数值范围约束**：
               - intimacy_level：-100到100的整数（负值表示敌对仇恨关系）
               - loyalty：0到100的整数
               - **rank：0到10的整数**（职位等级，0最低，10最高）
            6. 角色之间要形成合理的关系网络

            **示例说明**：
            - 如果生成了角色A、组织B、角色C，则角色A的organization_memberships只能是[组织B]，不能是其他组织
            - 如果角色A在数组第一位，它的relationships_array必须为空[]，因为还没有其他角色
            - 如果角色C在数组第三位，它的relationships_array可以引用角色A，但不能引用不存在的角色D

            再次强调：
            1. 只返回纯JSON数组，不要有```json```这样的标记
            2. 数组中必须精确包含{count}个对象
            3. 不要引用任何本批次中不存在的角色或组织名称
            4. 所有内容描述中严禁使用任何特殊符号，包括但不限于中文引号、英文引号、方括号、书名号等
            """;

    // ==================== 大纲生成 ====================

    /**
     * 向导大纲生成提示词（初始创建）
     * <p>
     * 参数：
     * - {title}: 书名
     * - {theme}: 主题
     * - {genre}: 类型
     * - {chapter_count}: 章节数量
     * - {narrative_perspective}: 叙事视角
     * - {target_words}: 目标字数
     * - {time_period}: 时间背景
     * - {location}: 地理位置
     * - {atmosphere}: 氛围基调
     * - {rules}: 世界规则
     * - {characters_info}: 角色信息
     * - {requirements}: 其他要求
     * </p>
     */
    public static final String OUTLINE_CREATE = """
            你是一位经验丰富的小说作家和编剧。请根据以下信息为小说生成**开篇{chapter_count}章**的大纲：

            【重要说明】
            本次任务是为项目初始化生成开头部分的大纲，而不是整本书的完整大纲。这些章节应该：
            - 完成故事的**开局设定**和**世界观展示**
            - 引入主要角色，建立初始关系
            - 埋下核心矛盾和悬念钩子
            - 为后续剧情发展打下基础
            - **不需要完整的故事闭环**，结尾应该为续写留出空间

            基本信息：
            - 书名：{title}
            - 主题：{theme}
            - 类型：{genre}
            - 开篇章节数：{chapter_count}
            - 叙事视角：{narrative_perspective}
            - 全书目标字数：{target_words}

            世界观：
            - 时间背景：{time_period}
            - 地理位置：{location}
            - 氛围基调：{atmosphere}
            - 世界规则：{rules}

            角色信息：
            {characters_info}

            其他要求：{requirements}

            开篇大纲要求：
            - **开局设定**：前几章完成世界观呈现、主角登场、初始状态建立
            - **矛盾引入**：引出核心冲突或故事主线，但不急于展开
            - **角色亮相**：主要角色依次登场，展示性格特点和相互关系
            - **节奏控制**：开篇不宜过快，给读者适应和代入的时间
            - **悬念设置**：埋下伏笔和钩子，为后续续写大纲预留发展空间
            - **视角统一**：采用{narrative_perspective}视角叙事
            - **留白艺术**：结尾不要收束过紧，要为后续剧情留出足够的发展空间

            **重要格式要求：**
            1. 只返回纯JSON数组格式，不要包含任何markdown标记、代码块标记或其他说明文字
            2. JSON字符串值的内容描述中严禁使用任何特殊符号（包括中文引号、英文引号、方括号、书名号等）
            3. 所有专有名词、事件名等直接书写，不使用任何符号包裹

            请严格按照以下JSON数组格式返回（共{chapter_count}个章节对象）：
            [
              {
                "chapter_number": 1,
                "title": "章节标题",
                "summary": "章节概要的详细描述（100-200字），包含主要情节、冲突、转折等",
                "scenes": ["场景1描述", "场景2描述", "场景3描述"],
                "characters": ["角色1", "角色2"],
                "key_points": ["情节要点1", "情节要点2"],
                "emotion": "本章情感基调",
                "goal": "本章叙事目标"
              },
              {
                "chapter_number": 2,
                "title": "章节标题",
                "summary": "章节概要...",
                "scenes": ["场景1", "场景2"],
                "characters": ["角色1", "角色2"],
                "key_points": ["要点1", "要点2"],
                "emotion": "情感基调",
                "goal": "叙事目标"
              }
            ]

            再次强调：
            1. 只返回纯JSON数组，不要有```json```这样的标记
            2. 数组中要包含{chapter_count}个章节对象
            3. 所有内容描述中严禁使用任何特殊符号
            """;

    /**
     * 大纲续写提示词（记忆增强版）
     * <p>
     * 用于在已有章节基础上续写大纲。
     * 参数：
     * - {title}: 书名
     * - {theme}: 主题
     * - {genre}: 类型
     * - {narrative_perspective}: 叙事视角
     * - {chapter_count}: 续写章节数
     * - {time_period}: 时间背景
     * - {location}: 地理位置
     * - {atmosphere}: 氛围基调
     * - {rules}: 世界规则
     * - {characters_info}: 角色信息
     * - {current_chapter_count}: 当前章节数
     * - {all_chapters_brief}: 已有章节概览
     * - {recent_plot}: 最近剧情
     * - {memory_context}: 记忆上下文
     * - {plot_stage_instruction}: 情节阶段指导
     * - {start_chapter}: 起始章节编号
     * - {end_chapter}: 结束章节编号
     * - {story_direction}: 故事发展方向
     * - {requirements}: 其他要求
     * </p>
     */
    public static final String OUTLINE_CONTINUE = """
            你是一位经验丰富的小说作家和编剧。请基于以下信息续写小说大纲：

            【项目信息】
            - 书名：{title}
            - 主题：{theme}
            - 类型：{genre}
            - 叙事视角：{narrative_perspective}
            - 续写章节数：{chapter_count}章

            【世界观】
            - 时间背景：{time_period}
            - 地理位置：{location}
            - 氛围基调：{atmosphere}
            - 世界规则：{rules}

            【角色信息】
            {characters_info}

            【已有章节概览】（共{current_chapter_count}章）
            {all_chapters_brief}

            【最近剧情】
            {recent_plot}

            【🧠 智能记忆系统 - 续写参考】
            以下是从故事记忆库中检索到的相关信息，请在续写大纲时参考：

            {memory_context}

            【续写指导】
            - 当前情节阶段：{plot_stage_instruction}
            - 起始章节编号：第{start_chapter}章
            - 故事发展方向：{story_direction}
            - 其他要求：{requirements}

            请生成第{start_chapter}章到第{end_chapter}章的大纲。
            要求：
            - **剧情连贯性**：与前文自然衔接，保持故事连贯性
            - **记忆参考**：适当参考记忆系统中的伏笔、钩子和情节点
            - **伏笔回收**：可以考虑回收未完结的伏笔，制造呼应
            - **角色发展**：遵循角色在前文中的成长轨迹
            - **情节阶段**：遵循情节阶段的发展要求
            - **风格一致**：保持与已有章节相同的风格和详细程度

            **重要格式要求：**
            1. 只返回纯JSON数组格式，不要包含任何markdown标记、代码块标记或其他说明文字
            2. JSON字符串值的内容描述中严禁使用任何特殊符号（包括中文引号、英文引号、方括号、书名号等）
            3. 所有专有名词直接书写，不使用任何符号包裹

            请严格按照以下JSON数组格式返回（共{chapter_count}个章节对象）：
            [
              {
                "chapter_number": {start_chapter},
                "title": "章节标题",
                "summary": "章节概要的详细描述（100-200字），包含主要情节、角色互动、关键事件、冲突与转折",
                "scenes": ["场景1描述", "场景2描述", "场景3描述"],
                "characters": ["涉及角色1", "涉及角色2"],
                "key_points": ["情节要点1", "情节要点2"],
                "emotion": "本章情感基调",
                "goal": "本章叙事目标"
              }
            ]

            再次强调：
            1. 只返回纯JSON数组，不要有```json```这样的标记
            2. 数组中要包含{chapter_count}个章节对象
            3. 每个summary必须是100-200字的详细描述
            4. 确保字段结构与已有章节完全一致
            5. 所有内容描述中严禁使用任何特殊符号
            """;

    // ==================== 章节生成 ====================

    /**
     * 章节创作提示词（基础版）
     * <p>
     * 用于根据大纲生成章节内容，无上下文。
     * 参数：
     * - {title}: 书名
     * - {theme}: 主题
     * - {genre}: 类型
     * - {narrative_perspective}: 叙事视角
     * - {time_period}: 时间背景
     * - {location}: 地理位置
     * - {atmosphere}: 氛围基调
     * - {rules}: 世界规则
     * - {characters_info}: 角色信息
     * - {outlines_context}: 全书大纲
     * - {chapter_number}: 章节序号
     * - {chapter_title}: 章节标题
     * - {chapter_outline}: 章节大纲
     * - {target_word_count}: 目标字数
     * - {max_word_count}: 最大字数
     * </p>
     */
    public static final String CHAPTER_GENERATION = """
            你是一位专业的小说作家。请根据以下信息创作本章内容：

            项目信息：
            - 书名：{title}
            - 主题：{theme}
            - 类型：{genre}
            - 叙事视角：{narrative_perspective}

            世界观：
            - 时间背景：{time_period}
            - 地理位置：{location}
            - 氛围基调：{atmosphere}
            - 世界规则：{rules}

            角色信息：
            {characters_info}

            全书大纲：
            {outlines_context}

            本章信息：
            - 章节序号：第{chapter_number}章
            - 章节标题：{chapter_title}
            - 章节大纲：{chapter_outline}

            创作要求：
            1. 严格按照大纲内容展开情节
            2. 保持与前后章节的连贯性
            3. 符合角色性格设定
            4. 体现世界观特色
            5. 使用{narrative_perspective}视角
            6. 字数要求：目标{target_word_count}字，不得低于{target_word_count}字，必须严格控制在{target_word_count}至{max_word_count}字之间
            7. 语言自然流畅，避免AI痕迹

            请直接输出章节正文内容，不要包含章节标题和其他说明文字。
            """;

    /**
     * 章节创作提示词（带上下文和记忆系统）
     * <p>
     * 用于根据大纲和前置章节生成章节内容。
     * 参数：
     * - {title}: 书名
     * - {theme}: 主题
     * - {genre}: 类型
     * - {narrative_perspective}: 叙事视角
     * - {time_period}: 时间背景
     * - {location}: 地理位置
     * - {atmosphere}: 氛围基调
     * - {rules}: 世界规则
     * - {characters_info}: 角色信息
     * - {outlines_context}: 全书大纲
     * - {previous_content}: 前置章节内容
     * - {memory_context}: 记忆上下文
     * - {chapter_number}: 章节序号
     * - {chapter_title}: 章节标题
     * - {chapter_outline}: 章节大纲
     * - {target_word_count}: 目标字数
     * - {max_word_count}: 最大字数
     * </p>
     */
    public static final String CHAPTER_GENERATION_WITH_CONTEXT = """
            你是一位专业的小说作家。请根据以下信息创作本章内容：

            项目信息：
            - 书名：{title}
            - 主题：{theme}
            - 类型：{genre}
            - 叙事视角：{narrative_perspective}

            世界观：
            - 时间背景：{time_period}
            - 地理位置：{location}
            - 氛围基调：{atmosphere}
            - 世界规则：{rules}

            角色信息：
            {characters_info}

            全书大纲：
            {outlines_context}

            【已完成的前置章节内容】
            {previous_content}

            【🧠 智能记忆系统 - 重要参考】
            以下是从故事记忆库中检索到的相关信息，请在创作时适当参考和呼应：

            {memory_context}

            本章信息：
            - 章节序号：第{chapter_number}章
            - 章节标题：{chapter_title}
            - 章节大纲：{chapter_outline}

            创作要求：
            1. **剧情连贯性（最重要）**：
               - 必须承接前面章节的剧情发展
               - 注意角色状态、情节进展、时间线的连续性
               - 不能出现与前文矛盾的内容
               - 自然过渡，避免突兀的跳跃

            2. **🔴 防止内容重复（关键）**：
               - ⚠️ 仔细阅读【上一章结尾内容】，绝对不要重复叙述已经发生的事件
               - ⚠️ 本章必须从新的情节点开始，不要重新描述上一章的场景或对话
               - ⚠️ 如果上一章以某个动作或对话结束，本章应该从紧接着的下一个动作或反应开始
               - ⚠️ 角色状态应该延续而非重置，不要让角色重新经历上一章已经经历的心理过程
               - ⚠️ 场景转换要明确，如果是同一场景的延续，要从不同的视角或新的细节切入

            3. **情节推进**：
               - 严格按照本章大纲（expansion_plan）展开情节
               - 推动故事向前发展，不要原地踏步
               - 保持与全书大纲的一致性
               - 确保本章有独特的叙事价值，而非前章内容的重复

            4. **角色一致性**：
               - 符合角色性格设定
               - 延续角色在前文中的成长和变化
               - 保持角色关系的连贯性

            5. **写作风格**：
               - 使用{narrative_perspective}视角
               - 字数要求：目标{target_word_count}字，不得低于{target_word_count}字，必须严格控制在{target_word_count}至{max_word_count}字之间
               - 语言自然流畅，避免AI痕迹
               - 体现世界观特色

            6. **承上启下**：
               - 开头自然衔接上一章结尾（但不重复上一章内容）
               - 结尾为下一章做好铺垫

            7. **记忆系统使用指南**：
               - **最近章节记忆**：保持情节连贯，注意角色状态和剧情发展
               - **语义相关记忆**：参考相似情节的处理方式
               - **未完结伏笔**：适当时机可以回收伏笔，制造呼应效果
               - **角色状态记忆**：确保角色行为符合其发展轨迹
               - **重要情节点**：与关键剧情保持一致

            请直接输出章节正文内容，不要包含章节标题和其他说明文字。
            """;

    // ==================== 辅助功能 ====================

    /**
     * AI去味提示词
     * <p>
     * 将AI生成的文本改写得更像人类作家的手笔。
     * 参数：
     * - {original_text}: 原始文本
     * </p>
     */
    public static final String AI_DENOISING = """
            你是一位追求自然写作风格的编辑。你的任务是将AI生成的文本改写得更像人类作家的手笔。

            原文：
            {original_text}

            修改要求：
            1. 去除AI痕迹：
               - 删除过于工整的排比句
               - 减少重复的修辞手法
               - 去掉刻意的对称结构
               - 避免机械式的总结陈词

            2. 增加人性化：
               - 使用更口语化的表达
               - 添加不完美的细节
               - 保留适度的随意性
               - 增加真实的情感波动

            3. 优化叙事：
               - 让节奏更自然不做作
               - 用简单词汇替换华丽辞藻
               - 保持叙述的松弛感
               - 让对话更生活化

            4. 保持原意：
               - 不改变核心情节
               - 保留关键信息点
               - 维持角色性格
               - 确保逻辑连贯

            修改风格：
            - 像是一个喜欢讲故事的普通人写的
            - 有点粗糙但很真诚
            - 自然流畅不刻意
            - 让人读起来很舒服

            请直接输出修改后的文本，无需解释。
            """;

    /**
     * 情节分析提示词
     * <p>
     * 用于深度分析章节内容。
     * 参数：
     * - {chapter_number}: 章节序号
     * - {title}: 章节标题
     * - {word_count}: 字数
     * - {content}: 章节内容
     * </p>
     */
    public static final String PLOT_ANALYSIS = """
            你是一位专业的小说编辑和剧情分析师。请深度分析以下章节内容:

            **章节信息:**
            - 章节: 第{chapter_number}章
            - 标题: {title}
            - 字数: {word_count}字

            **章节内容:**
            {content}

            ---

            **分析任务:**
            请从专业编辑的角度,全面分析这一章节:

            ### 1. 剧情钩子 (Hooks) - 吸引读者的元素
            识别能够吸引读者继续阅读的关键元素:
            - **悬念钩子**: 未解之谜、疑问、谜团
            - **情感钩子**: 引发共鸣的情感点、触动心弦的时刻
            - **冲突钩子**: 矛盾对抗、紧张局势
            - **认知钩子**: 颠覆认知的信息、惊人真相

            每个钩子需要:
            - 类型分类
            - 具体内容描述
            - 强度评分(1-10)
            - 出现位置(开头/中段/结尾)
            - **关键词**: 从章节原文中逐字复制一段关键文本(8-25字)

            ### 2. 伏笔分析 (Foreshadowing)
            - **埋下的新伏笔**: 描述内容、预期作用、隐藏程度(1-10)
            - **回收的旧伏笔**: 呼应哪一章、回收效果评分

            ### 3. 冲突分析 (Conflict)
            - 冲突类型: 人与人/人与己/人与环境/人与社会
            - 冲突各方及其立场
            - 冲突强度评分(1-10)
            - 冲突解决进度(0-100%)

            ### 4. 情感曲线 (Emotional Arc)
            - 主导情绪
            - 情感强度(1-10)
            - 情绪变化轨迹描述

            ### 5. 角色状态追踪 (Character Development)
            对每个出场角色分析:
            - 心理状态变化(前→后)
            - 关系变化
            - 关键行动和决策
            - 成长或退步

            ### 6. 关键情节点 (Plot Points)
            列出3-5个核心情节点

            ### 7. 质量评分
            - 节奏把控: 1-10分
            - 吸引力: 1-10分
            - 连贯性: 1-10分
            - 整体质量: 1-10分

            ### 8. 改进建议
            提供3-5条具体的改进建议

            ---

            **输出格式(纯JSON,不要markdown标记)**

            只返回JSON,不要其他说明。
            """;

    // ==================== 单个实体生成 ====================

    /**
     * 单个角色生成提示词
     * <p>
     * 参数：
     * - {project_context}: 项目上下文
     * - {user_input}: 用户输入
     * </p>
     */
    public static final String SINGLE_CHARACTER_GENERATION = """
            你是一位专业的角色设定师。请根据以下信息创建一个立体饱满的小说角色。

            {project_context}

            {user_input}

            请生成一个完整的角色卡片，包含以下所有信息：

            1. **基本信息**：
               - 姓名：如果用户未提供，请生成一个符合世界观的名字
               - 年龄：具体数字或年龄段
               - 性别：男/女/其他

            2. **外貌特征**（100-150字）：
               - 身高体型、面容特征、着装风格
               - 要符合角色定位和世界观设定

            3. **性格特点**（150-200字）：
               - 核心性格特质（至少3个）
               - 优点和缺点
               - 特殊习惯或癖好
               - 性格要有复杂性和矛盾性

            4. **背景故事**（200-300字）：
               - 家庭背景
               - 成长经历
               - 重要转折事件
               - 如何与项目主题关联

            5. **人际关系**：
               - 与现有角色的关系（如果有）
               - 重要的人际纽带

            6. **特殊能力/特长**：
               - 擅长的领域
               - 特殊技能或知识

            **重要格式要求：**
            1. 只返回纯JSON格式，不要包含任何markdown标记
            2. JSON字符串值中严禁使用特殊符号

            请严格按照JSON格式返回。

            **角色设定要求：**
            - 角色要符合项目的世界观和主题
            - 如果是主角，要有明确的成长空间和目标动机
            - 如果是反派，要有合理的动机，不能脸谱化
            - 配角要有独特性，不能是工具人

            只返回纯JSON对象，不要有```json```标记。
            """;

    /**
     * 单个组织生成提示词
     * <p>
     * 参数：
     * - {project_context}: 项目上下文
     * - {user_input}: 用户输入
     * </p>
     */
    public static final String SINGLE_ORGANIZATION_GENERATION = """
            你是一位专业的组织设定师。请根据以下信息创建一个完整的组织/势力设定。

            {project_context}

            {user_input}

            请生成一个完整的组织设定，包含以下所有信息：

            1. **基本信息**：
               - 组织名称
               - 组织类型：如帮派、公司、门派、学院、政府机构、宗教组织等
               - 成立时间

            2. **组织特性**（150-200字）：
               - 组织的核心理念和行事风格
               - 组织文化和价值观
               - 运作方式和管理模式

            3. **组织背景**（200-300字）：
               - 建立历史和起源
               - 发展历程和重要事件
               - 目前的地位和影响力

            4. **外在表现**（100-150字）：
               - 总部或主要据点位置
               - 标志性建筑或场所
               - 组织标志、徽章、制服等

            5. **组织目的/宗旨**：
               - 明确的组织目标
               - 长期愿景

            6. **势力等级**：
               - 在世界中的影响力（0-100）

            **组织设定要求：**
            - 组织要符合项目的世界观和主题
            - 目标和行动要合理
            - 要有存在的必要性，能推动故事发展

            只返回纯JSON对象，不要有```json```标记。
            """;
}
